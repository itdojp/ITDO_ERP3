# 財務管理モジュール（FI）詳細要求仕様書

## 1. モジュール概要

### 1.1 目的
財務管理モジュールは、企業の財務活動全般を管理し、正確な財務情報の記録、分析、報告を行うための包括的な機能を提供する。

### 1.2 対象ユーザー
- 経理部門
- 財務部門
- 管理会計担当者
- プロジェクトコントローラー
- 経営層
- 監査人

### 1.3 主要機能領域
- 一般会計
- 管理会計・原価計算
- 予算管理
- 資金管理
- 固定資産管理
- プロジェクト会計

## 2. 詳細機能要件

### 2.1 一般会計

#### 2.1.1 仕訳処理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-001 | 仕訳入力 | 手動仕訳の入力・登録 | 必須 |
| FI-002 | 自動仕訳 | 他モジュールからの自動仕訳生成 | 必須 |
| FI-003 | 仕訳テンプレート | 頻出仕訳のテンプレート管理 | 高 |
| FI-004 | 仕訳承認 | 仕訳の承認ワークフロー | 必須 |
| FI-005 | 仕訳取消・訂正 | 誤仕訳の取消と訂正処理 | 必須 |
| FI-006 | 繰返仕訳 | 定期的な仕訳の自動生成 | 高 |

#### 2.1.2 勘定科目管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-007 | 勘定科目マスタ | 勘定科目体系の管理 | 必須 |
| FI-008 | 補助科目管理 | 補助科目の設定と管理 | 必須 |
| FI-009 | 部門別科目 | 部門別勘定科目の設定 | 高 |
| FI-010 | 科目残高管理 | 勘定科目別残高の管理 | 必須 |

#### 2.1.3 帳簿管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-011 | 総勘定元帳 | 総勘定元帳の照会・出力 | 必須 |
| FI-012 | 仕訳帳 | 仕訳帳の照会・出力 | 必須 |
| FI-013 | 補助元帳 | 各種補助元帳の管理 | 必須 |
| FI-014 | 試算表 | 月次・年次試算表の作成 | 必須 |

### 2.2 売掛金管理

#### 2.2.1 債権管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-015 | 売掛金計上 | 売上に伴う売掛金の自動計上 | 必須 |
| FI-016 | 入金処理 | 入金の記録と売掛金消込 | 必須 |
| FI-017 | 債権年齢表 | 債権の経過期間別分析 | 必須 |
| FI-018 | 滞留債権管理 | 長期滞留債権の抽出とアラート | 高 |
| FI-019 | 貸倒引当金 | 貸倒引当金の計算と計上 | 高 |

#### 2.2.2 請求管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-020 | 請求書発行 | 請求書の作成と発行 | 必須 |
| FI-021 | 請求書再発行 | 請求書の再発行管理 | 高 |
| FI-022 | 締日管理 | 得意先別締日の管理 | 必須 |
| FI-023 | 回収予定管理 | 回収予定の登録と実績管理 | 高 |

### 2.3 買掛金管理

#### 2.3.1 債務管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-024 | 買掛金計上 | 仕入に伴う買掛金の計上 | 必須 |
| FI-025 | 支払処理 | 支払実行と買掛金消込 | 必須 |
| FI-026 | 支払予定表 | 支払予定の管理 | 必須 |
| FI-027 | 債務年齢表 | 債務の経過期間別分析 | 高 |

#### 2.3.2 支払管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-028 | 支払条件管理 | 仕入先別支払条件の設定 | 必須 |
| FI-029 | 支払承認 | 支払の承認ワークフロー | 必須 |
| FI-030 | 振込データ作成 | 銀行振込データの生成 | 高 |
| FI-031 | 支払通知書 | 支払通知書の発行 | 中 |

### 2.4 原価計算 ★優先度：高

#### 2.4.1 標準原価計算
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-032 | 標準原価設定 | 材料費・労務費・経費の標準原価設定 | 必須 |
| FI-033 | 原価積算 | BOMベースの原価積算 | 必須 |
| FI-034 | 原価差異分析 | 価格差異・数量差異・能率差異の計算 | 必須 |
| FI-035 | 差異配賦 | 原価差異の配賦処理 | 高 |
| FI-036 | 標準原価改定 | 定期的な標準原価の見直し | 高 |

#### 2.4.2 ABC原価計算
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-037 | 活動定義 | 原価計算用活動の定義 | 高 |
| FI-038 | コストドライバー | コストドライバーの設定と管理 | 高 |
| FI-039 | 活動原価配賦 | 活動別原価の製品への配賦 | 高 |
| FI-040 | 収益性分析 | 製品別・顧客別収益性分析 | 高 |

#### 2.4.3 直接原価計算
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-041 | 変動費・固定費分離 | 費用の変動費・固定費への分類 | 高 |
| FI-042 | 貢献利益計算 | 製品別・部門別貢献利益 | 高 |
| FI-043 | CVP分析 | 損益分岐点分析 | 高 |
| FI-044 | 限界利益分析 | 限界利益率の計算と分析 | 中 |

### 2.5 予算管理 ★優先度：高

#### 2.5.1 予算編成
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-045 | 予算体系設定 | 予算科目・部門体系の設定 | 必須 |
| FI-046 | トップダウン予算 | 経営層からの予算配賦 | 必須 |
| FI-047 | ボトムアップ予算 | 部門からの予算積上げ | 必須 |
| FI-048 | 予算調整 | 予算の調整と最終化 | 必須 |
| FI-049 | 予算承認 | 多段階予算承認フロー | 必須 |

#### 2.5.2 ローリング予算
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-050 | ローリング期間設定 | 四半期・月次ローリング設定 | 高 |
| FI-051 | 予算自動更新 | 期間経過に伴う自動更新 | 高 |
| FI-052 | 予測値入力 | 最新予測値の入力 | 高 |
| FI-053 | ローリング分析 | ローリング予算の推移分析 | 中 |

#### 2.5.3 予算統制
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-054 | 予算配賦 | 部門・プロジェクトへの配賦 | 必須 |
| FI-055 | 予算消化管理 | リアルタイム予算消化率 | 必須 |
| FI-056 | 予算超過制御 | 予算超過の警告・制限 | 必須 |
| FI-057 | 予実差異分析 | 予算実績差異の詳細分析 | 必須 |

### 2.6 資金管理 ★優先度：高

#### 2.6.1 資金繰り管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-058 | 資金繰り表作成 | 日次・週次・月次資金繰り表 | 必須 |
| FI-059 | 資金予測 | 将来の資金需要予測 | 必須 |
| FI-060 | 資金シミュレーション | What-if分析 | 高 |
| FI-061 | 資金過不足分析 | 資金余剰・不足の分析 | 必須 |

#### 2.6.2 手形管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-062 | 受取手形管理 | 受取手形の登録と期日管理 | 高 |
| FI-063 | 支払手形管理 | 支払手形の発行と決済管理 | 高 |
| FI-064 | 手形割引 | 手形割引の管理 | 中 |
| FI-065 | 裏書譲渡 | 裏書譲渡の記録 | 中 |

#### 2.6.3 ファクタリング
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-066 | 債権譲渡登録 | ファクタリング対象債権の登録 | 中 |
| FI-067 | 手数料計算 | ファクタリング手数料の計算 | 中 |
| FI-068 | 入金管理 | ファクタリング入金の管理 | 中 |

### 2.7 固定資産管理 ★優先度：高

#### 2.7.1 資産台帳管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-069 | 資産登録 | 新規資産の登録 | 必須 |
| FI-070 | 資産異動 | 移動・改良・一部除却 | 必須 |
| FI-071 | 資産除却・売却 | 除却・売却処理 | 必須 |
| FI-072 | 資産分類管理 | 資産種別・設置場所管理 | 必須 |
| FI-073 | バーコード/RFID | 資産タグ管理 | 高 |

#### 2.7.2 減価償却
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-074 | 償却方法設定 | 定額法・定率法・生産高比例法 | 必須 |
| FI-075 | 償却計算 | 月次・年次償却計算 | 必須 |
| FI-076 | 税務償却 | 税法基準の償却計算 | 必須 |
| FI-077 | 償却予定表 | 将来の償却予定 | 高 |
| FI-078 | 特別償却 | 特別償却の設定と計算 | 中 |

#### 2.7.3 資産棚卸
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-079 | 棚卸計画 | 棚卸実施計画の策定 | 高 |
| FI-080 | 現物確認 | モバイル端末での確認 | 高 |
| FI-081 | 差異分析 | 帳簿と現物の差異分析 | 高 |
| FI-082 | 棚卸調整 | 差異の調整処理 | 高 |

#### 2.7.4 リース資産
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-083 | リース契約登録 | リース契約情報の管理 | 高 |
| FI-084 | リース種別判定 | ファイナンス/オペレーティング判定 | 高 |
| FI-085 | IFRS16対応 | 使用権資産・リース負債計算 | 高 |
| FI-086 | リース料支払 | リース料の支払管理 | 高 |

### 2.8 プロジェクト会計

#### 2.8.1 プロジェクト原価管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-087 | プロジェクト予算 | プロジェクト別予算設定 | 必須 |
| FI-088 | 原価集計 | プロジェクト別原価集計 | 必須 |
| FI-089 | 工数原価計算 | 工数×単価の原価計算 | 必須 |
| FI-090 | 間接費配賦 | プロジェクトへの間接費配賦 | 高 |

#### 2.8.2 収益認識
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| FI-091 | 進行基準 | 工事進行基準の適用 | 高 |
| FI-092 | 完成基準 | 工事完成基準の適用 | 高 |
| FI-093 | マイルストーン基準 | マイルストーン達成による認識 | 高 |
| FI-094 | 収益認識調整 | 収益認識の調整処理 | 高 |

## 3. 画面要件

### 3.1 主要画面一覧
| 画面ID | 画面名 | 説明 | 対象ユーザー |
|--------|--------|------|--------------|
| FS-001 | 財務ダッシュボード | 財務KPI・資金状況の俯瞰 | 経営層、財務部門 |
| FS-002 | 仕訳入力画面 | 仕訳の入力・編集 | 経理担当 |
| FS-003 | 予算編成画面 | 予算の作成・調整 | 予算管理者 |
| FS-004 | 資金繰り表 | 資金繰りの確認・分析 | 財務担当 |
| FS-005 | 原価分析画面 | 原価の詳細分析 | 管理会計担当 |
| FS-006 | 固定資産台帳 | 資産情報の照会・管理 | 資産管理担当 |

### 3.2 財務ダッシュボード要件
- 主要財務指標（売上高、営業利益、経常利益、純利益）
- キャッシュフロー状況（営業CF、投資CF、財務CF）
- 資金繰り予測（30日、60日、90日）
- 予算消化状況（部門別、費目別）
- 売掛金・買掛金残高推移
- 財務比率（流動比率、自己資本比率、ROE、ROA）

## 4. レポート要件

### 4.1 法定帳票
| レポートID | レポート名 | 出力形式 | 頻度 |
|------------|------------|----------|------|
| FR-001 | 貸借対照表 | PDF/Excel | 月次/年次 |
| FR-002 | 損益計算書 | PDF/Excel | 月次/年次 |
| FR-003 | キャッシュフロー計算書 | PDF/Excel | 月次/年次 |
| FR-004 | 株主資本等変動計算書 | PDF/Excel | 年次 |
| FR-005 | 総勘定元帳 | PDF/Excel | 随時 |

### 4.2 管理帳票
| レポートID | レポート名 | 出力形式 | 頻度 |
|------------|------------|----------|------|
| FR-006 | 部門別損益 | PDF/Excel | 月次 |
| FR-007 | プロジェクト別収支 | PDF/Excel | 月次 |
| FR-008 | 予算実績対比表 | PDF/Excel | 月次 |
| FR-009 | 資金繰り実績表 | PDF/Excel | 日次/週次 |
| FR-010 | 原価差異分析表 | PDF/Excel | 月次 |

## 5. データ要件

### 5.1 マスターデータ
| データ項目 | 説明 | データ型 | 制約 |
|------------|------|----------|------|
| 勘定科目コード | 勘定科目の識別子 | VARCHAR(10) | PK, NOT NULL |
| 勘定科目名 | 勘定科目の名称 | VARCHAR(100) | NOT NULL |
| 貸借区分 | 借方/貸方の区分 | CHAR(1) | NOT NULL |
| 集計区分 | BS/PLの区分 | VARCHAR(10) | NOT NULL |
| 税区分 | 消費税区分 | VARCHAR(10) | |

### 5.2 トランザクションデータ
| データ項目 | 説明 | データ型 | 制約 |
|------------|------|----------|------|
| 仕訳番号 | 仕訳の一意識別子 | VARCHAR(20) | PK, NOT NULL |
| 仕訳日付 | 仕訳の発生日 | DATE | NOT NULL |
| 借方科目 | 借方勘定科目 | VARCHAR(10) | FK, NOT NULL |
| 借方金額 | 借方の金額 | DECIMAL(15,2) | NOT NULL |
| 貸方科目 | 貸方勘定科目 | VARCHAR(10) | FK, NOT NULL |
| 貸方金額 | 貸方の金額 | DECIMAL(15,2) | NOT NULL |

## 6. 外部インターフェース

### 6.1 他モジュール連携
| 連携先 | 連携内容 | 連携方式 | 頻度 |
|--------|----------|----------|------|
| 販売管理 | 売上・売掛金データ | API | リアルタイム |
| 購買管理 | 仕入・買掛金データ | API | リアルタイム |
| 在庫管理 | 在庫評価データ | API | 日次 |
| 人事管理 | 給与・賞与データ | API | 月次 |
| プロジェクト管理 | プロジェクトコスト | API | リアルタイム |

### 6.2 外部システム連携
| システム | 連携内容 | プロトコル | 認証方式 |
|----------|----------|------------|----------|
| 銀行システム | 入出金明細、残高照会 | API/SFTP | 電子証明書 |
| 税務申告システム | 申告データ | XML | - |
| 監査法人システム | 監査資料 | SFTP | ID/PW |
| 経費精算システム | 経費データ | REST API | OAuth2.0 |

## 7. 非機能要件

### 7.1 パフォーマンス要件
- 仕訳入力：1秒以内のレスポンス
- 月次決算処理：4時間以内
- 試算表作成：30秒以内
- 財務レポート生成：1分以内

### 7.2 セキュリティ要件
- 仕訳の改ざん防止（ブロックチェーン技術の活用検討）
- 承認権限の階層管理
- 監査証跡の完全記録
- 金額上限設定による不正防止

### 7.3 コンプライアンス要件
- 会計基準準拠（日本基準/IFRS）
- 税法対応（法人税、消費税）
- 内部統制対応（J-SOX）
- 電子帳簿保存法対応

## 8. 業務フロー

### 8.1 月次決算フロー
```
1. 月次締め処理
   ↓
2. 自動仕訳生成（減価償却、引当金等）
   ↓
3. 部門別原価集計
   ↓
4. 配賦処理実行
   ↓
5. 試算表作成
   ↓
6. 決算整理仕訳
   ↓
7. 財務諸表作成
   ↓
8. 承認・確定
```

### 8.2 予算編成フロー
```
1. 予算編成方針策定
   ↓
2. 部門予算要求
   ↓
3. ヒアリング・調整
   ↓
4. 予算原案作成
   ↓
5. 経営承認
   ↓
6. 予算配賦
   ↓
7. 予算統制開始
```

## 9. 移行要件

### 9.1 データ移行
- 勘定科目マスタの完全移行
- 過去3年分の仕訳データ
- 未決済の債権債務データ
- 固定資産台帳データ
- 予算データ

### 9.2 並行稼働
- 3ヶ月間の並行稼働
- 日次での残高照合
- 段階的な機能移行

## 10. 用語定義

| 用語 | 定義 |
|------|------|
| BS | Balance Sheet - 貸借対照表 |
| PL | Profit and Loss statement - 損益計算書 |
| CF | Cash Flow - キャッシュフロー |
| ROE | Return on Equity - 自己資本利益率 |
| ROA | Return on Assets - 総資産利益率 |
| ABC | Activity Based Costing - 活動基準原価計算 |
| CVP | Cost-Volume-Profit - 原価・販売量・利益分析 |
| IFRS | International Financial Reporting Standards - 国際財務報告基準 |
| J-SOX | 日本版SOX法（内部統制報告制度） |
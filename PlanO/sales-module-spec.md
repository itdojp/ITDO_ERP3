# 販売管理モジュール詳細要求仕様書

## 1. モジュール概要

### 1.1 目的
販売管理モジュールは、見積から受注、出荷、請求、回収までの販売プロセス全体を統合管理し、営業活動の効率化と収益性の向上を実現する。

### 1.2 対象ユーザー
- 営業部門
- 受注管理部門
- 出荷・物流部門
- 経理部門（請求・回収）
- 与信管理部門
- 経営管理層

### 1.3 主要機能領域
- 受注管理（優先度：高）
- 価格管理
- 与信管理（優先度：高）
- 在庫引当・出荷管理
- 請求・売上管理
- 販売分析

## 2. 詳細機能要件

### 2.1 受注管理 ★★★優先度：高

#### 2.1.1 見積管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-001 | 見積書作成 | 見積書の新規作成・編集 | 必須 |
| SM-002 | 見積テンプレート | 標準見積フォーマット管理 | 必須 |
| SM-003 | 見積バージョン管理 | 改訂履歴の管理 | 必須 |
| SM-004 | 見積承認ワークフロー | 金額別承認ルート | 必須 |
| SM-005 | 見積有効期限管理 | 期限切れアラート | 高 |
| SM-006 | 見積複製 | 既存見積からのコピー作成 | 高 |
| SM-007 | 見積→受注変換 | ワンクリック受注登録 | 必須 |

#### 2.1.2 受注処理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-008 | 受注登録 | 受注情報の新規登録 | 必須 |
| SM-009 | 受注変更管理 | 数量・納期等の変更処理 | 必須 |
| SM-010 | 受注キャンセル | キャンセル処理と在庫戻し | 必須 |
| SM-011 | 受注ステータス管理 | 受注～出荷完了までの状態管理 | 必須 |
| SM-012 | 受注承認 | 与信・在庫確認後の承認 | 必須 |
| SM-013 | バックオーダー管理 | 在庫不足時の受注管理 | 高 |
| SM-014 | 分割出荷対応 | 複数回に分けた出荷 | 高 |

#### 2.1.3 納期管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-015 | 納期回答 | ATP（Available to Promise）確認 | 必須 |
| SM-016 | 納期調整 | 生産・調達との納期調整 | 高 |
| SM-017 | 納期遅延アラート | 遅延予測と通知 | 高 |
| SM-018 | 優先順位付け | 受注の優先度設定 | 中 |
| SM-019 | 納期変更通知 | 顧客への自動通知 | 高 |

#### 2.1.4 出荷指示
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-020 | 出荷指示書発行 | ピッキングリスト作成 | 必須 |
| SM-021 | 出荷ロット管理 | ロット番号の記録 | 高 |
| SM-022 | 梱包指示 | 梱包仕様の指定 | 中 |
| SM-023 | 配送手配 | 運送会社の手配 | 高 |
| SM-024 | 出荷実績登録 | 実際の出荷記録 | 必須 |

### 2.2 価格管理

#### 2.2.1 価格マスタ管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-025 | 標準価格設定 | 製品別標準価格 | 必須 |
| SM-026 | 顧客別価格 | 特別価格の設定 | 高 |
| SM-027 | 価格表管理 | 複数価格表の管理 | 高 |
| SM-028 | 通貨別価格 | 多通貨価格設定 | 中 |
| SM-029 | 価格有効期限 | 期間限定価格 | 高 |

#### 2.2.2 割引管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-030 | 数量割引 | ボリュームディスカウント | 高 |
| SM-031 | 期間割引 | 期間限定割引 | 高 |
| SM-032 | 顧客ランク割引 | 顧客グレード別割引 | 中 |
| SM-033 | 商品別割引 | 特定商品の割引設定 | 高 |
| SM-034 | 割引承認 | 特別割引の承認フロー | 高 |

#### 2.2.3 キャンペーン価格
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-035 | キャンペーン設定 | 販促キャンペーン登録 | 高 |
| SM-036 | バンドル価格 | セット販売価格 | 中 |
| SM-037 | クーポン管理 | 割引クーポンの発行・管理 | 中 |
| SM-038 | ポイント管理 | ポイント付与・利用 | 低 |

#### 2.2.4 利益管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-039 | 粗利計算 | 受注時点の粗利算出 | 必須 |
| SM-040 | 利益率シミュレーション | 価格変更時の影響分析 | 高 |
| SM-041 | 最低利益率設定 | 下限利益率の設定 | 高 |
| SM-042 | 競合価格分析 | 競合他社価格との比較 | 中 |

### 2.3 与信管理 ★★★優先度：高

#### 2.3.1 与信限度額管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-043 | 与信限度額設定 | 顧客別限度額の設定 | 必須 |
| SM-044 | 与信グループ管理 | 企業グループ単位の管理 | 高 |
| SM-045 | 一時的限度額変更 | 期間限定の増額 | 高 |
| SM-046 | 与信見直し | 定期的な限度額見直し | 高 |
| SM-047 | 保証金管理 | 預かり保証金の管理 | 中 |

#### 2.3.2 与信チェック
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-048 | 自動与信チェック | 受注時の自動確認 | 必須 |
| SM-049 | 与信残高計算 | リアルタイム残高管理 | 必須 |
| SM-050 | 与信オーバー制御 | 超過時の受注停止 | 必須 |
| SM-051 | 与信承認ワークフロー | 例外承認プロセス | 必須 |
| SM-052 | 与信警告 | 限度額接近アラート | 高 |

#### 2.3.3 債権年齢分析
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-053 | 債権年齢表作成 | 期日経過別債権分析 | 必須 |
| SM-054 | 滞留債権抽出 | 長期滞留債権のリスト化 | 必須 |
| SM-055 | 回収予定管理 | 入金予定の管理 | 必須 |
| SM-056 | 督促管理 | 督促状発行・履歴管理 | 高 |
| SM-057 | 貸倒リスク評価 | リスクスコアリング | 高 |

#### 2.3.4 ブラックリスト管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-058 | ブラックリスト登録 | 取引停止先の登録 | 高 |
| SM-059 | グレーリスト管理 | 要注意先の管理 | 高 |
| SM-060 | 自動取引停止 | ブラックリスト先の受注拒否 | 高 |
| SM-061 | 解除申請 | ブラックリスト解除フロー | 中 |

### 2.4 在庫引当・出荷管理

#### 2.4.1 在庫引当
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-062 | 在庫引当処理 | 受注に対する在庫確保 | 必須 |
| SM-063 | 引当優先順位 | 顧客・受注別優先度 | 高 |
| SM-064 | 部分引当 | 一部在庫の引当 | 高 |
| SM-065 | 引当解除 | キャンセル時の在庫戻し | 必須 |
| SM-066 | 代替品提案 | 在庫不足時の代替提案 | 中 |

#### 2.4.2 出荷処理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-067 | 出荷検品 | 出荷前検品記録 | 高 |
| SM-068 | 納品書発行 | 納品書の作成・印刷 | 必須 |
| SM-069 | 送り状発行 | 運送会社伝票作成 | 高 |
| SM-070 | 出荷確定 | 出荷実績の確定 | 必須 |
| SM-071 | 配送追跡 | トラッキング番号管理 | 中 |

### 2.5 請求・売上管理

#### 2.5.1 請求処理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-072 | 請求書発行 | 請求書の作成・発行 | 必須 |
| SM-073 | 締日処理 | 顧客別締日での請求 | 必須 |
| SM-074 | 合算請求 | 複数納品の合算請求 | 高 |
| SM-075 | 分割請求 | 分割払い請求 | 中 |
| SM-076 | 請求書再発行 | 再発行管理 | 高 |

#### 2.5.2 売上計上
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-077 | 売上計上基準 | 出荷/検収基準の選択 | 必須 |
| SM-078 | 売上確定 | 売上の確定処理 | 必須 |
| SM-079 | 売上取消 | 返品時の売上取消 | 必須 |
| SM-080 | 月次締め | 月次売上締め処理 | 必須 |

#### 2.5.3 入金管理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-081 | 入金登録 | 入金情報の記録 | 必須 |
| SM-082 | 入金消込 | 請求と入金の照合 | 必須 |
| SM-083 | 入金差額処理 | 過不足の処理 | 高 |
| SM-084 | 前受金管理 | 前払い金の管理 | 中 |

### 2.6 返品・クレーム管理

#### 2.6.1 返品処理
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-085 | 返品受付 | 返品申請の登録 | 高 |
| SM-086 | 返品承認 | 返品可否の判定 | 高 |
| SM-087 | 返品入庫 | 返品商品の入庫処理 | 高 |
| SM-088 | 返金処理 | 返金額の計算・処理 | 高 |

#### 2.6.2 クレーム対応
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SM-089 | クレーム登録 | クレーム内容の記録 | 高 |
| SM-090 | 対応履歴管理 | 対応状況の追跡 | 高 |
| SM-091 | 補償処理 | 値引き・交換等の処理 | 中 |
| SM-092 | 再発防止管理 | 原因分析と対策 | 中 |

## 3. 画面要件

### 3.1 主要画面一覧
| 画面ID | 画面名 | 説明 | 対象ユーザー |
|--------|--------|------|--------------|
| SS-001 | 受注登録画面 | 受注情報の入力 | 営業、受注管理 |
| SS-002 | 受注一覧画面 | 受注状況の確認 | 営業、管理者 |
| SS-003 | 与信管理画面 | 与信状況の確認・設定 | 与信管理、経理 |
| SS-004 | 価格設定画面 | 価格マスタの管理 | 営業管理者 |
| SS-005 | 出荷指示画面 | 出荷作業の指示 | 物流部門 |
| SS-006 | 請求管理画面 | 請求書発行・管理 | 経理部門 |

### 3.2 受注登録画面要件
- 顧客情報の検索・選択
- 商品の検索・追加（バーコード対応）
- 価格・数量の入力
- 納期の設定・確認
- 与信チェック結果表示
- 在庫確認機能
- 見積からの転記機能
- 承認申請機能

## 4. レポート要件

### 4.1 販売レポート
| レポートID | レポート名 | 出力形式 | 頻度 |
|------------|------------|----------|------|
| SR-001 | 売上日報 | PDF/Excel | 日次 |
| SR-002 | 受注残レポート | PDF/Excel | 日次 |
| SR-003 | 売上実績表 | PDF/Excel | 月次 |
| SR-004 | 得意先別売上 | PDF/Excel | 月次 |
| SR-005 | 商品別売上 | PDF/Excel | 月次 |

### 4.2 与信レポート
| レポートID | レポート名 | 出力形式 | 頻度 |
|------------|------------|----------|------|
| SR-006 | 与信残高一覧 | PDF/Excel | 日次 |
| SR-007 | 債権年齢表 | PDF/Excel | 月次 |
| SR-008 | 滞留債権リスト | PDF/Excel | 週次 |
| SR-009 | 回収予定表 | PDF/Excel | 日次 |

## 5. データ要件

### 5.1 マスターデータ
| データ項目 | 説明 | データ型 | 制約 |
|------------|------|----------|------|
| 受注番号 | 受注の一意識別子 | VARCHAR(20) | PK, NOT NULL |
| 顧客コード | 顧客識別子 | VARCHAR(20) | FK, NOT NULL |
| 商品コード | 商品識別子 | VARCHAR(20) | FK, NOT NULL |
| 受注日 | 受注日付 | DATE | NOT NULL |
| 納期 | 納品予定日 | DATE | NOT NULL |
| 受注金額 | 合計金額 | DECIMAL(15,2) | NOT NULL |

### 5.2 トランザクションデータ
| データ項目 | 説明 | データ型 | 制約 |
|------------|------|----------|------|
| 出荷番号 | 出荷識別子 | VARCHAR(20) | PK, NOT NULL |
| 受注番号 | 対応する受注 | VARCHAR(20) | FK, NOT NULL |
| 出荷日 | 実際の出荷日 | DATE | NOT NULL |
| 出荷数量 | 出荷した数量 | INTEGER | NOT NULL |
| 売上金額 | 売上計上額 | DECIMAL(15,2) | NOT NULL |

## 6. 外部インターフェース

### 6.1 他モジュール連携
| 連携先 | 連携内容 | 連携方式 | 頻度 |
|--------|----------|----------|------|
| 在庫管理 | 在庫引当・出荷 | API | リアルタイム |
| 財務管理 | 売上・債権データ | API | 日次 |
| CRM | 顧客情報・商談 | API | リアルタイム |
| 生産管理 | 納期回答・計画 | API | リアルタイム |

### 6.2 外部システム連携
| システム | 連携内容 | プロトコル | 認証方式 |
|----------|----------|------------|----------|
| EDI | 受発注データ | AS2/SFTP | 証明書 |
| EC サイト | Web受注 | REST API | OAuth2.0 |
| 物流システム | 配送情報 | REST API | APIキー |
| 決済システム | クレジット決済 | REST API | Token |

## 7. 非機能要件

### 7.1 パフォーマンス要件
- 受注登録：3秒以内
- 在庫引当：1秒以内
- 与信チェック：2秒以内
- 請求書作成：1000件を10分以内

### 7.2 セキュリティ要件
- 価格情報の暗号化
- 与信情報のアクセス制限
- 受注変更の監査ログ
- 金額上限チェック

### 7.3 可用性要件
- 24時間365日稼働（計画停止除く）
- 受注登録の二重化
- 自動バックアップ

## 8. 業務フロー

### 8.1 受注から出荷までのフロー
```
1. 見積作成・提出
   ↓
2. 受注登録
   ↓
3. 与信チェック
   ↓
4. 在庫引当
   ↓
5. 受注確定
   ↓
6. 出荷指示
   ↓
7. ピッキング・梱包
   ↓
8. 出荷・配送
   ↓
9. 納品完了
```

### 8.2 請求・回収フロー
```
1. 売上計上
   ↓
2. 請求締め処理
   ↓
3. 請求書発行
   ↓
4. 入金確認
   ↓
5. 入金消込
   ↓
6. 滞留確認
   ↓
7. 督促処理
```

## 9. 移行要件

### 9.1 データ移行
- 顧客マスタ・商品マスタ
- 進行中の受注データ
- 過去2年分の売上データ
- 売掛金残高
- 与信限度額設定

### 9.2 並行稼働
- 新規受注から新システム利用
- 既存受注は旧システムで完了
- 3ヶ月間の並行運用

## 10. 用語定義

| 用語 | 定義 |
|------|------|
| ATP | Available to Promise - 供給可能数量 |
| EDI | Electronic Data Interchange - 電子データ交換 |
| 与信限度額 | 顧客に対する売掛金の上限額 |
| 債権年齢 | 売掛金の経過日数による分類 |
| バックオーダー | 在庫不足による受注保留 |
| 締日 | 請求書作成の基準日 |
| 消込 | 請求と入金の照合処理 |
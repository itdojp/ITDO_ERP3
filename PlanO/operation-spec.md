# 運用管理仕様書

## 1. 概要

### 1.1 目的
本仕様書は、ERPシステムの安定稼働を実現するための運用管理要件を定義し、システムの可用性、信頼性、保守性を確保するための運用体制と手順を明確化する。

### 1.2 適用範囲
- システム運用体制
- 運用監視
- バックアップ・リカバリ
- ジョブ管理
- 変更管理・リリース管理
- インシデント・問題管理
- キャパシティ管理

### 1.3 運用方針
- 24時間365日の安定稼働
- 予防保守の徹底
- 自動化による運用効率化
- ITIL準拠の運用プロセス
- 継続的な改善活動

## 2. 運用体制

### 2.1 運用組織

#### 2.1.1 運用体制図
```
         [運用統括責任者]
               |
    +----------+----------+
    |                     |
[運用管理チーム]    [インフラチーム]
    |                     |
    +------+------+       +------+------+
    |             |       |             |
[監視班]    [ジョブ班]  [サーバー班]  [ネットワーク班]
```

#### 2.1.2 役割と責任
| 役割 | 責任範囲 | 人員 | 対応時間 |
|------|---------|------|----------|
| 運用統括責任者 | 運用全体統括、エスカレーション判断 | 1名 | 平日9-18時 |
| 運用リーダー | 日次運用管理、問題解決 | 2名 | 24時間（シフト） |
| 監視オペレーター | システム監視、一次対応 | 4名 | 24時間（シフト） |
| ジョブオペレーター | バッチジョブ管理 | 2名 | 24時間（シフト） |
| インフラエンジニア | インフラ保守、問題対応 | 3名 | 平日9-18時+オンコール |
| アプリケーションエンジニア | アプリ保守、障害対応 | 4名 | 平日9-18時+オンコール |

### 2.2 運用拠点

#### 2.2.1 拠点配置
| 拠点 | 役割 | 設備 | 人員配置 |
|------|------|------|----------|
| 主監視センター | 24時間監視 | 監視システム、運用端末 | 常時2名以上 |
| 副監視センター | バックアップ監視 | 監視システム | リモート対応 |
| データセンター | インフラ設置 | サーバー、ネットワーク機器 | 無人（リモート） |
| DR サイト | 災害時切替 | バックアップシステム | 無人（リモート） |

### 2.3 エスカレーション

#### 2.3.1 エスカレーションフロー
```
[アラート検知] → [L1: 監視オペレーター] → [L2: 運用リーダー] → [L3: 各専門チーム]
     ↓                ↓(15分)                    ↓(30分)              ↓(1時間)
[自動通知]        [初期対応]                [原因調査]          [本格対応]
                                                                      ↓
                                                            [L4: ベンダー/経営層]
```

#### 2.3.2 エスカレーション基準
| レベル | 条件 | 対応時間 | 通知先 |
|--------|------|----------|--------|
| 情報 | 通常運用の範囲内 | - | ログ記録のみ |
| 注意 | 性能劣化、閾値接近 | 1時間以内 | 運用チーム |
| 警告 | 一部機能停止 | 30分以内 | 運用リーダー |
| 重大 | 主要機能停止 | 15分以内 | 管理者+関係部門 |
| 緊急 | 全面停止、データ損失リスク | 即時 | 経営層含む全関係者 |

## 3. サービスレベル管理

### 3.1 SLA（Service Level Agreement）

#### 3.1.1 可用性SLA
| サービス | 目標稼働率 | 計画停止 | 測定方法 |
|---------|-----------|----------|----------|
| 基幹業務システム | 99.9% | 月4時間以内 | (稼働時間-停止時間)/稼働時間 |
| 情報系システム | 99.5% | 月8時間以内 | 同上 |
| 開発・テスト環境 | 95.0% | 制限なし | 同上 |

#### 3.1.2 性能SLA
| 指標 | 目標値 | 測定条件 | 測定方法 |
|------|--------|----------|----------|
| オンライン応答時間 | 3秒以内（95%ile） | 通常時 | APM ツール |
| バッチ処理時間 | 6時間以内 | 日次処理 | ジョブ管理システム |
| 同時接続数 | 1,000ユーザー | ピーク時 | 接続数モニタリング |

### 3.2 OLA（Operational Level Agreement）

#### 3.2.1 内部サービスレベル
| サービス | 目標値 | 備考 |
|---------|--------|------|
| インシデント一次対応 | 15分以内 | アラート受信から |
| 障害復旧時間 | 4時間以内 | 重大障害 |
| 変更作業成功率 | 98%以上 | 月間平均 |
| バックアップ成功率 | 100% | 日次バックアップ |

## 4. 運用監視

### 4.1 監視体系

#### 4.1.1 監視レイヤー
| レイヤー | 監視対象 | 監視ツール | 監視間隔 |
|---------|---------|------------|----------|
| インフラ監視 | サーバー、ネットワーク、ストレージ | Zabbix/Datadog | 1分 |
| ミドルウェア監視 | DB、Web/APサーバー、MQ | 専用エージェント | 1分 |
| アプリケーション監視 | アプリログ、トランザクション | APM（AppDynamics） | リアルタイム |
| ビジネス監視 | KPI、業務プロセス | カスタムダッシュボード | 5分 |
| セキュリティ監視 | 不正アクセス、脆弱性 | SIEM（Splunk） | リアルタイム |

#### 4.1.2 主要監視項目
| 監視項目 | 警告閾値 | 危険閾値 | 対応 |
|---------|----------|----------|------|
| CPU使用率 | 70% | 90% | スケールアウト検討 |
| メモリ使用率 | 80% | 95% | メモリ追加/プロセス再起動 |
| ディスク使用率 | 70% | 90% | ディスク追加/データ削除 |
| ネットワーク帯域 | 60% | 80% | 帯域追加/トラフィック分散 |
| DB接続数 | 80% | 95% | 接続プール調整 |
| 応答時間 | 3秒 | 5秒 | 性能チューニング |

### 4.2 ログ管理

#### 4.2.1 ログ収集
| ログ種別 | 保存期間 | 収集方法 | 保存先 |
|---------|----------|----------|--------|
| システムログ | 3ヶ月 | rsyslog | ログサーバー |
| アプリケーションログ | 1年 | Fluentd | Elasticsearch |
| アクセスログ | 1年 | Filebeat | Elasticsearch |
| 監査ログ | 5年 | 専用Agent | 監査DB+アーカイブ |
| セキュリティログ | 2年 | SIEM連携 | SIEM+アーカイブ |

#### 4.2.2 ログ分析
| 分析項目 | 頻度 | ツール | アウトプット |
|---------|------|--------|-------------|
| エラー分析 | 日次 | Kibana | エラーレポート |
| パフォーマンス分析 | 週次 | APM | 性能レポート |
| セキュリティ分析 | 常時 | SIEM | セキュリティアラート |
| 利用統計 | 月次 | 独自ツール | 利用状況レポート |

## 5. バックアップ・リカバリ

### 5.1 バックアップ計画

#### 5.1.1 バックアップ方式
| 対象 | 方式 | 頻度 | 保持期間 | RPO |
|------|------|------|----------|-----|
| データベース（本番） | フル+増分 | フル:週次、増分:日次 | 35日 | 1日 |
| データベース（重要） | レプリケーション | リアルタイム | - | 1分 |
| ファイルシステム | 差分 | 日次 | 30日 | 1日 |
| システムイメージ | フル | 月次 | 3世代 | 1ヶ月 |
| 設定ファイル | Git管理 | 変更時 | 無期限 | 0 |

#### 5.1.2 バックアップスケジュール
| 時間帯 | 処理内容 | 優先度 |
|--------|---------|--------|
| 0:00-2:00 | DB増分バックアップ | 高 |
| 2:00-4:00 | ファイルバックアップ | 中 |
| 土曜 22:00-翌6:00 | DBフルバックアップ | 高 |
| 月末 22:00-翌6:00 | システムフルバックアップ | 中 |

### 5.2 リカバリ手順

#### 5.2.1 リカバリシナリオ
| シナリオ | RTO | RPO | リカバリ手順 |
|---------|-----|-----|------------|
| データ誤削除 | 1時間 | 削除直前 | バックアップから該当データ復元 |
| DB障害 | 2時間 | 1時間 | スタンバイDBへ切替→復旧 |
| サーバー障害 | 4時間 | 1日 | 代替サーバーでシステム復旧 |
| サイト災害 | 8時間 | 1日 | DRサイトへ切替 |

#### 5.2.2 リカバリテスト
| テスト種別 | 頻度 | 対象 | 成功基準 |
|-----------|------|------|----------|
| バックアップ確認 | 日次 | 全バックアップ | 正常終了 |
| リストアテスト | 月次 | サンプルデータ | データ整合性確認 |
| DR訓練 | 年2回 | 全システム | RTO/RPO達成 |

## 6. ジョブ管理

### 6.1 バッチジョブ体系

#### 6.1.1 ジョブ分類
| 分類 | 実行タイミング | ジョブ数 | 重要度 |
|------|---------------|---------|--------|
| 日次業務ジョブ | 毎日 20:00-翌6:00 | 約200 | 高 |
| 月次締めジョブ | 月末月初 | 約50 | 高 |
| 随時ジョブ | オンデマンド | 約30 | 中 |
| システムジョブ | 定期実行 | 約100 | 中 |

#### 6.1.2 主要ジョブネット
| ジョブネット | 開始時刻 | 処理内容 | 依存関係 | SLA |
|-------------|----------|----------|----------|-----|
| 売上締め | 20:00 | 日次売上集計 | なし | 22:00完了 |
| 在庫更新 | 22:00 | 在庫残高計算 | 売上締め完了後 | 24:00完了 |
| 会計連携 | 0:00 | 仕訳データ作成 | 売上・在庫完了後 | 2:00完了 |
| データ集計 | 2:00 | BI用データ作成 | 会計連携完了後 | 5:00完了 |
| バックアップ | 3:00 | DB/ファイルバックアップ | 全ジョブ完了後 | 6:00完了 |

### 6.2 ジョブ運用

#### 6.2.1 ジョブ管理ツール
| 項目 | 仕様 | 備考 |
|------|------|------|
| ジョブスケジューラー | JP1/Automatic Job Management System | 統合運用管理 |
| ジョブ定義 | ジョブネット形式 | 依存関係定義 |
| 実行制御 | カレンダー制御 | 営業日/休日考慮 |
| 監視 | リアルタイム監視 | 遅延/異常検知 |
| 通知 | メール/Slack通知 | 異常時自動通知 |

#### 6.2.2 ジョブ異常時対応
| 異常種別 | 検知方法 | 対応手順 | エスカレーション |
|---------|----------|----------|------------------|
| ジョブ異常終了 | 終了コード≠0 | ログ確認→リトライ | 3回失敗で通知 |
| ジョブ遅延 | SLA超過 | 原因調査→並行処理 | 30分遅延で通知 |
| ジョブ未実行 | スケジュール監視 | 手動起動 | 即時通知 |
| リソース不足 | リソース監視 | リソース追加/調整 | 即時対応 |

## 7. 変更管理

### 7.1 変更管理プロセス

#### 7.1.1 変更区分
| 区分 | 説明 | 承認レベル | リードタイム |
|------|------|-----------|--------------|
| 標準変更 | 事前承認済み定型作業 | 自動承認 | 即時 |
| 通常変更 | 一般的な変更作業 | 変更諮問委員会 | 1週間 |
| 緊急変更 | 緊急対応が必要 | 緊急承認 | 24時間以内 |
| 重大変更 | 大規模/高リスク | 経営承認 | 2週間以上 |

#### 7.1.2 変更管理フロー
```
[変更要求] → [影響評価] → [CAB審査] → [承認] → [計画] → [実施] → [確認] → [クローズ]
                ↓                          ↓         ↓        ↓        ↓
            [リスク分析]              [却下]  [ロールバック計画] [検証] [レビュー]
```

### 7.2 リリース管理

#### 7.2.1 リリースサイクル
| リリース種別 | 頻度 | 内容 | 停止時間 |
|-------------|------|------|----------|
| 定期リリース | 月1回 | 機能追加/改善 | 2-4時間 |
| パッチリリース | 随時 | バグ修正 | 0-1時間 |
| 緊急リリース | 随時 | 緊急修正 | 0-30分 |
| メジャーリリース | 年2回 | 大規模更新 | 8時間 |

#### 7.2.2 リリース手順
| フェーズ | 作業内容 | 実施者 | 確認事項 |
|---------|---------|--------|----------|
| 事前準備 | 環境確認、バックアップ | 運用チーム | チェックリスト |
| リリース作業 | デプロイ、設定変更 | 開発/運用 | 手順書確認 |
| 動作確認 | 機能テスト、性能確認 | QAチーム | テストケース |
| 切り戻し判定 | Go/NoGo判定 | リリース責任者 | 判定基準 |
| 本番切替 | トラフィック切替 | 運用チーム | 監視強化 |

## 8. インシデント管理

### 8.1 インシデント対応

#### 8.1.1 インシデント分類
| レベル | 影響範囲 | 対応時間目標 | 例 |
|--------|---------|--------------|-----|
| レベル1（軽微） | 個人/少数 | 1営業日 | 画面表示不具合 |
| レベル2（中度） | 部門/機能 | 4時間 | 一部機能停止 |
| レベル3（重大） | 複数部門 | 2時間 | 主要機能停止 |
| レベル4（緊急） | 全社 | 30分 | システム全停止 |

#### 8.1.2 インシデント対応フロー
```
[検知/受付] → [記録] → [分類] → [優先度設定] → [調査] → [解決] → [確認] → [クローズ]
                           ↓                        ↓
                    [エスカレーション]          [回避策提供]
```

### 8.2 問題管理

#### 8.2.1 問題分析
| 分析手法 | 用途 | 実施タイミング |
|---------|------|---------------|
| 根本原因分析（RCA） | 重大インシデント | インシデント解決後 |
| トレンド分析 | 繰り返し発生 | 月次 |
| なぜなぜ分析 | 原因深堀り | 随時 |
| FMEA | リスク評価 | 四半期 |

#### 8.2.2 是正措置
| 措置種別 | 内容 | 期限 |
|---------|------|------|
| 暫定対策 | 回避策の実施 | 即時-1日 |
| 恒久対策 | 根本原因の除去 | 1週間-1ヶ月 |
| 予防措置 | 再発防止策 | 1ヶ月-3ヶ月 |

## 9. キャパシティ管理

### 9.1 キャパシティ計画

#### 9.1.1 リソース管理
| リソース | 現在使用率 | 閾値 | 増強計画 |
|---------|-----------|------|----------|
| CPU | 40% | 70% | 使用率60%で検討 |
| メモリ | 60% | 80% | 使用率70%で追加 |
| ストレージ | 50% | 70% | 年30%増加想定 |
| ネットワーク帯域 | 30% | 60% | 使用率50%で増速 |
| DBコネクション | 40% | 80% | 接続数増加時調整 |

#### 9.1.2 成長予測
| 項目 | 現在 | 1年後 | 3年後 | 対応策 |
|------|------|--------|--------|--------|
| ユーザー数 | 500 | 800 | 1,500 | スケールアウト |
| データ量 | 1TB | 2TB | 5TB | ストレージ増設 |
| トランザクション/日 | 10万 | 20万 | 50万 | 性能強化 |

### 9.2 パフォーマンス管理

#### 9.2.1 性能監視
| 監視項目 | 測定方法 | 目標値 | 現在値 |
|---------|----------|--------|--------|
| 平均応答時間 | APM | <2秒 | 1.5秒 |
| スループット | トランザクション/秒 | >100 | 120 |
| 同時接続数 | 接続数監視 | <1000 | 400 |
| バッチ処理時間 | ジョブ実行時間 | <6時間 | 4時間 |

#### 9.2.2 チューニング
| 対象 | チューニング項目 | 実施時期 |
|------|-----------------|----------|
| データベース | インデックス最適化、統計情報更新 | 週次 |
| アプリケーション | キャッシュ調整、SQLチューニング | 月次 |
| インフラ | カーネルパラメータ、JVMチューニング | 四半期 |

## 10. 運用報告

### 10.1 定期報告

#### 10.1.1 報告体系
| 報告書 | 頻度 | 対象者 | 内容 |
|--------|------|--------|------|
| 日次運用報告 | 毎日 | 運用チーム | インシデント、ジョブ状況 |
| 週次サマリー | 週次 | IT管理者 | 稼働状況、問題点 |
| 月次運用報告 | 月次 | 経営層 | SLA達成状況、改善提案 |
| 四半期レビュー | 四半期 | 全関係者 | トレンド分析、計画見直し |

#### 10.1.2 KPI報告
| KPI | 目標 | 測定方法 | 報告頻度 |
|-----|------|----------|----------|
| システム稼働率 | 99.9% | (稼働時間-停止)/稼働時間 | 月次 |
| インシデント解決率 | 95% | 解決数/発生数 | 月次 |
| 変更成功率 | 98% | 成功数/実施数 | 月次 |
| SLA達成率 | 100% | 達成項目/全項目 | 月次 |
| MTTR（平均復旧時間） | <4時間 | 総復旧時間/件数 | 月次 |

## 11. 災害対策

### 11.1 BCP（事業継続計画）

#### 11.1.1 想定災害と対策
| 災害種別 | 影響 | 対策 | 目標復旧時間 |
|---------|------|------|--------------|
| 地震 | データセンター被災 | DRサイト切替 | 8時間 |
| 停電 | システム停止 | UPS/自家発電 | 0（無停止） |
| ネットワーク障害 | 接続不可 | 冗長回線切替 | 5分 |
| サイバー攻撃 | データ破壊/漏洩 | バックアップ復元 | 24時間 |
| パンデミック | 要員不足 | リモート運用 | 継続運用 |

#### 11.1.2 DR（Disaster Recovery）構成
| 項目 | 主サイト | DRサイト | 切替方法 |
|------|---------|----------|----------|
| 場所 | 東京DC | 大阪DC | - |
| データ同期 | マスター | レプリカ（非同期） | 自動/手動 |
| システム構成 | フル構成 | 最小構成 | スケールアップ可 |
| 切替時間 | - | 4-8時間 | DNS切替+起動 |

### 11.2 訓練計画

#### 11.2.1 訓練実施計画
| 訓練種別 | 頻度 | 参加者 | 内容 |
|---------|------|--------|------|
| 机上訓練 | 四半期 | 運用チーム | 手順確認 |
| 部分訓練 | 半期 | 関連部門 | 特定システム切替 |
| 総合訓練 | 年次 | 全社 | 全面切替訓練 |

## 12. 運用自動化

### 12.1 自動化対象

#### 12.1.1 自動化領域
| 領域 | 自動化内容 | ツール | 効果 |
|------|-----------|--------|------|
| 監視 | 異常検知、通知 | Zabbix/Datadog | 24時間監視 |
| デプロイ | アプリケーション配布 | Ansible/Jenkins | 作業時間短縮 |
| スケーリング | リソース自動調整 | Kubernetes/AutoScale | 負荷対応 |
| バックアップ | 定期バックアップ | スクリプト | 作業ミス削減 |
| レポート | 定期レポート生成 | Python/Shell | 作業効率化 |

### 12.2 RPA活用

#### 12.2.1 RPA適用業務
| 業務 | 処理内容 | 頻度 | 削減時間 |
|------|---------|------|----------|
| ログチェック | エラーログ抽出 | 日次 | 30分/日 |
| 利用者管理 | アカウント作成/削除 | 随時 | 20分/件 |
| 定期報告 | レポート作成/送付 | 週次/月次 | 2時間/月 |
| データ投入 | マスタ一括登録 | 随時 | 1時間/回 |

## 13. ベンダー管理

### 13.1 ベンダー体制

#### 13.1.1 ベンダー一覧
| ベンダー | 担当領域 | 契約形態 | SLA |
|---------|---------|----------|-----|
| A社 | アプリケーション保守 | 年間保守 | 99.9% |
| B社 | インフラ保守 | 年間保守 | 99.9% |
| C社 | クラウドサービス | 従量課金 | 99.95% |
| D社 | 監視サービス | 月額固定 | 24時間対応 |

#### 13.1.2 ベンダー管理
| 管理項目 | 内容 | 頻度 |
|---------|------|------|
| 定例会議 | 運用状況レビュー | 月次 |
| SLA評価 | サービスレベル確認 | 月次 |
| 問題管理 | エスカレーション | 随時 |
| 契約更新 | 契約内容見直し | 年次 |

## 14. コンプライアンス

### 14.1 運用規程

#### 14.1.1 準拠規程
| 規程 | 内容 | 監査 |
|------|------|------|
| 情報セキュリティポリシー | セキュリティ基準 | 年次 |
| 個人情報保護規程 | 個人情報取扱 | 年次 |
| IT統制規程 | J-SOX対応 | 四半期 |
| 事業継続計画 | BCP/DR | 年次 |

#### 14.1.2 監査対応
| 監査種別 | 頻度 | 対応事項 |
|---------|------|----------|
| 内部監査 | 年2回 | 運用記録提出 |
| 外部監査 | 年1回 | 証跡提供 |
| セキュリティ監査 | 年1回 | 脆弱性対応 |

## 15. 改善活動

### 15.1 継続的改善

#### 15.1.1 改善サイクル
```
[測定] → [分析] → [改善案] → [実施] → [評価] → [標準化]
   ↑                                           ↓
   └─────────────────────────────────────────┘
```

#### 15.1.2 改善指標
| 指標 | 現状 | 目標 | 改善施策 |
|------|------|------|----------|
| 自動化率 | 60% | 80% | RPA/スクリプト化推進 |
| インシデント数 | 50件/月 | 30件/月 | 予防保守強化 |
| MTTR | 4時間 | 2時間 | 手順改善、自動復旧 |
| 運用コスト | 100% | 80% | 効率化、最適化 |

## 16. 用語定義

| 用語 | 定義 |
|------|------|
| SLA | Service Level Agreement - サービスレベル合意 |
| MTTR | Mean Time To Repair - 平均復旧時間 |
| MTBF | Mean Time Between Failures - 平均故障間隔 |
| RTO | Recovery Time Objective - 目標復旧時間 |
| RPO | Recovery Point Objective - 目標復旧時点 |
| CAB | Change Advisory Board - 変更諮問委員会 |
| ITIL | Information Technology Infrastructure Library |
| BCP | Business Continuity Plan - 事業継続計画 |
| RCA | Root Cause Analysis - 根本原因分析 |